<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>{{ product.name }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/product_page.css') }}">
</head>
<body>
    <div class="product-container">
        <!-- Галерея зображень -->
        <div class="product-gallery">
            {% if product.images %}
                <img id="main-image" src="{{ url_for('static', filename='images/' ~ product.images[0]) }}" alt="{{ product.name }}">
                <div class="thumbnail-container">
                    {% for image in product.images %}
                        <img class="thumbnail" src="{{ url_for('static', filename='images/' ~ image) }}" alt="{{ product.name }}">
                    {% endfor %}
                </div>
            {% else %}
                <img src="{{ url_for('static', filename='images/placeholder.jpg') }}" alt="Зображення відсутнє">
            {% endif %}
        </div>

        <!-- Інформація про товар -->
        <div class="product-info">
            <h1>{{ product.name }}</h1>
            <div class="price-section">
                <span class="price">{{ product.price }} грн</span>
            </div>

            <div class="attributes">
                <div class="colors">
                    <span>Кольори:</span>
                    {% for color in product.attributes.colors %}
                        <div class="color-box" style="background-color: {{ color }}"></div>
                    {% endfor %}
                </div>

                <div class="sizes">
                    <span>Розміри:</span>
                    {% for size in product.attributes.sizes %}
                        <button class="size-button">{{ size }}</button>
                    {% endfor %}
                </div>
            </div>

            <button class="add-to-cart">Додати в кошик</button>

            <!-- Акордіони -->
            <div class="accordions">
                {% if product.care %}
                <div class="accordion">
                    <div class="accordion-header">
                        <span class="accordion-title">Догляд</span>
                        <span class="accordion-icon"> ᐳ </span>
                    </div>
                    <div class="accordion-content">
                        <p>{{ product.care }}</p>
                    </div>
                </div>
                {% endif %}

                <div class="accordion">
                    <div class="accordion-header">
                        <span class="accordion-title">Опис</span>
                        <span class="accordion-icon"> ᐳ </span>
                    </div>
                    <div class="accordion-content">
                        <p>{{ product.description }}</p>
                    </div>
                </div>
            </div>

            <!-- Секція коментарів (НОВЕ) -->
            <div class="comments-section">
                <h2>Коментарі ({{ comments|length }})</h2>
                <form class="comment-form" method="POST" action="/add_comment">
                    <textarea name="comment" placeholder="Залишити коментар..." required></textarea>
                    <button type="submit">Відправити</button>
                </form>
                <div class="comments-list">
                    {% for comment in comments %}
                    <div class="comment">
                        <div class="comment-header">
                            <span class="author">{{ comment.author }}</span>
                            <span class="date">{{ comment.date }}</span>
                        </div>
                        <p class="text">{{ comment.text }}</p>
                    </div>
                    {% else %}
                    <p>Ще немає коментарів. Будьте першим!</p>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>

    <!-- Схожі товари -->
    {% if related_products %}
        <div class="related-products">
            <h2>Рекомендовані товари</h2>
            <div class="related-grid">
                {% for related in related_products %}
                    <div class="related-item">
                        {% if related.images %}
                            <img src="{{ url_for('static', filename='images/' ~ related.images[0]) }}" alt="{{ related.name }}">
                        {% else %}
                            <img src="{{ url_for('static', filename='images/placeholder.jpg') }}" alt="Зображення відсутнє">
                        {% endif %}
                        <h3>{{ related.name }}</h3>
                        <p>{{ related.price }} грн</p>
                    </div>
                {% endfor %}
            </div>
        </div>
    {% endif %}

    <script>
        // Скрипт для мініатюр
        const thumbnails = document.querySelectorAll('.thumbnail');
        const mainImage = document.getElementById('main-image');

        thumbnails.forEach(thumbnail => {
            thumbnail.addEventListener('click', () => {
                mainImage.src = thumbnail.src;
            });
        });

        // Скрипт для акордіонів
        document.querySelectorAll('.accordion-header').forEach(header => {
            header.addEventListener('click', () => {
                const accordion = header.parentElement;
                const isActive = accordion.classList.contains('active');

                document.querySelectorAll('.accordion').forEach(a => {
                    a.classList.remove('active');
                    a.querySelector('.accordion-content').style.maxHeight = '0';
                    a.querySelector('.accordion-icon').style.transform = 'rotate(0deg)';
                });

                if (!isActive) {
                    accordion.classList.add('active');
                    const content = accordion.querySelector('.accordion-content');
                    content.style.maxHeight = content.scrollHeight + 'px';
                    accordion.querySelector('.accordion-icon').style.transform = 'rotate(90deg)';
                }
            });
        });
    </script>
</body>
</html>